# [1] 확률: 확률의 개념과 특징

---

## 1. 확률의 기본 개념

---

> 확률 모형

- 시행을 반복할 때마다 나오는 결과가 우연에 의존하여 매번 달라지는 현상 또는 실험(확률 실험)에 대한 수리적 모형

> 확률

- 표본공간 : 확률 실험에서의 모든 관찰 가능한 결과의 집합, S로 표기

> 사건

- 표본공간의 임의의 부분집합, A,B 등으로 표기



## 2. 확률의 정의 및 성질

> 고전적 접근

- n개의 실험 결과를 구성된 표본공간에서 각 실험결과가 일어날 가능성이 같은 경우, m(m ≤ n)개의 실험 결과로 구성된 사건 A의 확률을 아래와 같이 정의함
  P(A) = m / n

> 상대적 비율에 의한 접근

- n번의 반복된 실험 중 어떤 사건 A가 발생한 횟수를 m이라고 할 때, 사건 A의 상대빈도는 m/n으로 구해짐
- 이 실험의 반복 횟수 n을 무한히 증가했을 때, 사건 A의 상대빈도가 수렴하는 값을 사건 A의 확률로 정의하고자 함

> 확률의 공리

1) 임의의 사건 A에 대하여 P(A) ≥ 0
2) P(S) = 1
3) 표본공간 S에 정의된 서로 상호배반인 사건 A1, A2 ... 에 대하여 P(A1 U A2 U ...) = P(A1) + P(A2) + ... 가 성립
   * 상호배반: 동시에 발생하지 않음

> 여사건의 확률

- P[A^C]: 사건 A를 제외한 나머지 사건의 확률
- P[A^C] = 1-P[A]

> 곱사건의 확률

- P[A ∩ B]: 사건 A와 사건 B가 동시에  발생할 확률

> 합사건의 확률

- P[A U B]: 사건 A또는 사건 B가 발생할 확률
- P[A U B]: P[A] + P[B]-P[A ∩ B]



## 3. 조건부 확률과 독립

> 조건부 확률의 정의

- A와 B가 표본공간 S 상에 정의되어 있으며 P(B) > 0라고 가정
  이 때 사건 B가 일어났다는 가정 하의 사건 A가 일어날 조건부 확률은 다음과 같이 정의됨
  P(A|B) = P[A ∩ B] / P(B)

> 독립 사건의 정의

- 두 사건 A와 B가 다음 중 하나를 만족시키면 서로 독립이라고 함.
  (단, P(A) > 0, P(B) > 0)
  1. P(A|B) = P(A)
  2. **P[A ∩ B] = P(A) * P(B)**
  3. P(A|B) = P(B)

---

# [2] 확률: 베이즈 정리

---

## 1. 표본공간의 분할과 전확률 공식

> 표본공간의 분할

- 𝐵1,…,𝐵𝑘가다음 조건을 만족하면 표본 공간 𝑆의 분할이라고 함.
  - 서로다른𝑖,𝑗에대해𝐵𝑖 ∩𝐵𝑗 = ∅ : 상호배반
  - 𝐵1 ∪𝐵2 ∪ ⋯∪𝐵𝑘 = 𝑆 𝑘 = 3인 경우
- 𝑘 = 3인 경우

![image-20220228172213744](C:\Users\vjkim\AppData\Roaming\Typora\typora-user-images\image-20220228172213744.png)

>전확률공식

- 사건 𝐵1,𝐵2, . . . ,𝐵𝑘는 상호배반이며, 𝐵1 ∪ ⋯∪ 𝐵𝑘 = 𝑆라고 함. 

- 이 때 𝑆에서 정의되는 임의의 사건 𝐴에 대하여 다음이 성립.
  𝑃 (𝐴) = 𝑃 (𝐴 ∩ 𝐵1) + ⋯+ 𝑃 (𝐴 ∩ 𝐵1) 
           = 𝑃 (𝐵1) 𝑃 (𝐴|𝐵1) + ⋯+ 𝑃 (𝐵𝑘) 𝑃 (𝐴|𝐵𝑘)

- 𝑘 = 3인 경우

  ![image-20220228172646902](C:\Users\vjkim\AppData\Roaming\Typora\typora-user-images\image-20220228172646902.png)

  

## 2. 베이즈 정리

> 베이즈 정리

- 데이터라는 조건이 주어졌을 때의 조건부 확률을 구하는 공식

- 사건 𝐵1,𝐵2, . . . ,𝐵𝑘는 상호배반이며, 𝐵1 ∪ ⋯∪ 𝐵𝑘 = 𝑆라고 함. 

- 이 때 사건 𝐴가일어났다는 조건 하에서 사건 𝐵𝑖가 일어날 확률은 다음과 같음.
  𝑃 (𝐵𝑖 |𝐴) = 𝑃 (𝐴 ∩ 𝐵𝑖) / 𝑃 (𝐴) 
                  = 𝑃 (𝐵𝑖) 𝑃 (𝐴|𝐵𝑖)  /  𝑃 (𝐵1) 𝑃 (𝐴|𝐵1) + ⋯ + 𝑃 (𝐵𝑘) 𝑃 (𝐴|𝐵𝑘)

  ![image-20220228173128200](C:\Users\vjkim\AppData\Roaming\Typora\typora-user-images\image-20220228173128200.png)

> 베이즈 정리 활용

- 𝐵1,𝐵2, . . . ,𝐵𝑘 으로 분할된 사건의 각 확률을 알고, 각𝐵i를 전제로 했을 때의 사건 𝐴가 발생할 조건부 확률을 알 때, 사건𝐴를 전제로 한 각 𝐵i의 조건부 확률을 구하기 위한 정리

  ![image-20220228173353150](C:\Users\vjkim\AppData\Roaming\Typora\typora-user-images\image-20220228173353150.png)

- [생산률] 기계 1 = 0.5, 기계 2 = 0.3, 기계 3 = 0.2
  [불량률] 기계 1 = 0.10, 기계 2 = 0.15, 기계 3 = 0.20
- P(기계1|불량) = 0.5 * 0.10 / (0.5 * 0.10) + (0.3 * 0.15) + (0.2 * 0.20)
                            = 0.3703
                            => 어떠한 불량이 기계 1로부터 나왔을 확률

## 3. 연습문제

> 어느 표본공간 S에서 정의된 사건 A와 사건 B에 대한 확률이 P[A] = 0.8, P[A^C] = 0.2, P[B|A] = 0.4, P[B|A^C] = 0.7 로 알려져 있다고 하자.
> P[B|A]는 얼마인가?

- 베이즈 정리를 이용하면, 
  **P[A|B] = P[B|A]P[A])/(P[B|A]P[A]+P[B|Ac]P[Ac])**
               **=(0.4*0.8)/(0.4*0.8+0.7*0.2)=0.6956**이 된다

> 어느 제조업체는 서로 다른 두 공급자 A1, A2로부터 원자재를 공급받는데, A1으로부터 전체 원자재의 40%를, A2으로부터 나머지 60%를 공급받고 있다. 또한 A1이 공급하는 원자재는 30%가 좋은 품질을 가지며, A2가 공급하는 원자재는 60%가 좋은 품질을 가진다고 한다. 이 제조업체가 사용하는 전체 원자재 중 좋은 품질의 비율은 얼마인가? (정답예시: 0.12)

- 각 공급자 별 공급비율이 P[A1]=0.4, P[A2]=0.6이고, 각 공급자 별 공급량 중 좋은 품질(B)의 비율이 P[B|A1]=0.3, P[B|A2]=0.6이므로, 
  전체 중 좋은 품질의 비율 P[B]는 전확률공식에 의해 
  **P[B] = P[B|A1]P[A1]+P[B|A2]P[A2]**
          **= 0.4*0.3+0.6*0.6=0.48**로 구해진다.

> 어느 제품을 생산하는 공장에서는 전체의 5%가 불량인 제품이다. 이를 선별하기 위하여 이 공장에서는 불량여부를 예측하는 통계 모델을 이용하여 완성된 제품의 불량 여부를 진단하고 있다고 하자. 그런데 이 예측 모델은 완벽하지 않아서 실제 불량인데 불량이라고 예측하는 경우가 99%이고, 실제로 정상인데 불량이라고 예측하는 경우가 2%라고 하자. 이 예측 모델에 의해 불량이라고 예측된 제품이 실제로 정상 제품일 확률은 얼마인가? 

- 실제로 정상 제품인 경우를 사건 N, 실제로 불량 제품인 경우를 사건 D라고 할 때, P[N]=0.95, P[D]=0.05로 주어져 있다. 

  또한 예측모델에 의해 불량으로 예측된 경우를 사건 F라고 하면, 실제 정상인 제품이 불량으로 예측될 확률 P[F|N]=0.02, 실제 불량인 제품이 불량으로 예측될 확률은 P[F|D]=0.99로 주어져 있다. 

  따라서 어떤 제품이 예측모델에 의해 불량으로 예측되었을 때 실제로 정상 제품일 확률은 베이즈 정리를 이용하여 
  **P[N|F]=(0.95 x 0.02) / {(0.95 x 0.02) + (0.05 x 0.99)} = 0.2773**이 된다.